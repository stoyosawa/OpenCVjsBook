<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta charset="UTF-8">
  <link rel=stylesheet type="text/css" href="style.css">
  <script async src="libs/opencv.js" type="text/javascript"></script>
</head>
<body>

<h1>リサイズ</h1>

<div>
  <img id="imageTag" width="40" src="samples/pike-st-market.jpg"/>
  <canvas id="canvasTag" class="placeholder"></canvas>
</div>
<div>
  <select id="selectTag"></select>
</div>  

<script>
  let imgElem = document.getElementById('imageTag');
  let selectElem = document.getElementById('selectTag');

  function addOptions() {
    let re = new RegExp('^INTER_');
    let inter = Object.keys(cv).filter(prop => re.test(prop));
    inter.forEach(function(e){
      let elem = new Option(e, cv[e]);
      selectElem.appendChild(elem);
    });
    selectElem.addEventListener('change', imgProc);
  }

  var Module = {
    onRuntimeInitialized: function() {
      addOptions();
      imgProc();
    }
  }
  function imgProc(evt) {
    let inter = cv.INTER_LINEAR;
    if (evt) {
      inter = parseInt(evt.target.value);
      console.log(selectElem.options[selectElem.selectedIndex].text);
    }
    let src = cv.imread(imgElem);
    let dst = new cv.Mat();
    cv.resize(src, dst, new cv.Size(), 10, 10, inter);
    cv.imshow('canvasTag', dst);
    src.delete();
    dst.delete();
  }
</script>

</body>
</html>