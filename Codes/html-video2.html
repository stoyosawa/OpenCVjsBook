<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta charset="UTF-8">
  <link rel=stylesheet type="text/css" href="style.css">
</head>
<body>

<h1>ビデオキャプチャ</h1>

<div>
  <video id="videoTag" width="480" autoplay muted src="samples/cat.mp4"></video>
  <canvas id="canvasTag" class="placeholder"></canvas>
</div>
<div>
  <input type="button" value="Snap!" class="click" onclick="showImage();"/>
</div>  

<script>
  let videoElem = document.getElementById('videoTag');
  let canvasElem = document.getElementById('canvasTag');
  let ctx = canvasElem.getContext('2d');

  function showImage() {
    canvasElem.width = videoElem.offsetWidth;
    canvasElem.height = videoElem.offsetHeight;
    ctx.drawImage(videoElem, 0, 0, videoElem.offsetWidth, videoElem.offsetHeight);

    let quality = videoElem.getVideoPlaybackQuality();
    let frameNumber = quality.totalVideoFrames;
    let currentTime = videoElem.currentTime;
    ctx.font = '16px sans-serif';
    ctx.fillText(`Snapped at ${frameNumber} ${currentTime}`, 10, 30);
  }

  videoElem.addEventListener('loadeddata', showImage);
</script>

</body>
</html>